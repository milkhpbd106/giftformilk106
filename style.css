// script.js

const countdownText = document.getElementById("countdown-text");
const passwordContainer = document.getElementById("password-container");
const mainContent = document.getElementById("main-content");
const passwordInput = document.getElementById("password-input");
const submitPassword = document.getElementById("submit-password");
const passwordError = document.getElementById("password-error");
const introVideo = document.getElementById("intro-video");
const loopVideo = document.getElementById("loop-video");
const bgMusic = document.getElementById("bg-music");
const messagesDiv = document.getElementById("messages");
const extraMessagesDiv = document.getElementById("extra-messages");
const openGiftButton = document.getElementById("open-gift");
const giftImagesDiv = document.getElementById("gift-images");
const feedbackBox = document.getElementById("feedback-box");
const feedbackText = document.getElementById("feedback-text");
const submitFeedback = document.getElementById("submit-feedback");
const cancelFeedback = document.getElementById("cancel-feedback");

// Countdown logic
const birthday = new Date("2025-06-07T00:00:00").getTime();
const now = new Date().getTime();

if (now < birthday) {
  countdownText.textContent = `Trang quà sinh nhật của cậu sẽ mở vào lúc 00:00 ngày 7/6/2025 nhé 🎂`;
} else {
  countdownText.classList.add("hidden");
  passwordContainer.classList.remove("hidden");
}

submitPassword.addEventListener("click", () => {
  const password = passwordInput.value;
  if (password === "milk") {
    passwordContainer.classList.add("hidden");
    mainContent.classList.remove("hidden");
    introVideo.play();
  } else {
    passwordError.textContent = "Mật khẩu không đúng rồi 😢";
  }
});

introVideo.addEventListener("ended", () => {
  introVideo.classList.add("hidden");
  loopVideo.classList.remove("hidden");
  loopVideo.play();
  bgMusic.play();
  displayMessages();
});

function displayMessages() {
  const messages = [
    "Happy Birthday Milk 🎉",
    "Tớ làm cái này tặng cậu nè...",
    "Hy vọng cậu sẽ thích nó 💝",
    "Từng thứ nhỏ xíu tớ cũng nghĩ tới cậu cả đó ✨",
    "Bấm nút dưới này thử xem 🎁"
  ];
  messages.forEach((msg, i) => {
    setTimeout(() => {
      const p = document.createElement("p");
      p.textContent = msg;
      p.classList.add("msg");
      messagesDiv.appendChild(p);
    }, i * 3000);
  });
  setTimeout(() => {
    openGiftButton.classList.remove("hidden");
  }, messages.length * 3000);
}

openGiftButton.addEventListener("click", () => {
  giftImagesDiv.classList.remove("hidden");
  feedbackBox.classList.remove("hidden");
});

submitFeedback.addEventListener("click", () => {
  const feedback = feedbackText.value.trim();
  if (feedback) {
    alert("Cảm ơn cậu đã nhắn lại điều gì đó 💌");
    feedbackText.value = "";
  }
});

cancelFeedback.addEventListener("click", () => {
  feedbackText.value = "";
});

// Sparkle effect
window.addEventListener("click", (e) => {
  const sparkle = document.createElement("div");
  sparkle.className = "sparkle";
  sparkle.style.left = `${e.clientX}px`;
  sparkle.style.top = `${e.clientY}px`;
  document.body.appendChild(sparkle);
  setTimeout(() => sparkle.remove(), 1000);
});
